function showLoader(){$("body").css("overflow-y","visible");$.busyLoadFull("show")}function hideLoader(){$.busyLoadFull("hide")}$.busyLoadSetup({color:"#57ae80",background:"rgba(219, 222, 219 , 0.30)"});$("body").on("click",".btn-in-basket",function(){NProgress.start();var t=$(this).attr("data-id"),i=$("#amount").val()==null?1:parseInt($("#amount").val()),n=$(this).attr("data-slider-id");$.ajax({url:"/card/add-product-to-basket",type:"GET",dataType:"json",data:{id:t,amount:i},success:function(n){NProgress.done();n.status?($(".count").html(n.count),toastr.success("Товар успешно добавлен в корзину.")):swal("","Извините, у нас нет больше!","error")},error:function(){NProgress.done();Swal.fire("Упс!","Что-то пошло не так.","error")}});n!=null&&$.ajax({url:"/catalog/offer-related-products",type:"GET",data:{id:t},success:function(t){t!=0&&($("#"+n).html(t),$(".owl2").owlCarousel({loop:!1,margin:10,nav:!0,responsive:{0:{items:2},600:{items:3},1e3:{items:5,nav:!0}}}),document.getElementById(n).scrollIntoView({behavior:"smooth",block:"end",inline:"start"}))},error:function(){Swal.fire("Упс!","Что-то пошло не так.","error")}});let r=$(".owl2 > .owl-item");r.length<5&&($(".owl-prev").hide(),$(".owl-next").hide())});$(".btn-in-basket-gift").click(function(){NProgress.start();var n=$(this).attr("data-id");$.ajax({url:"/card/add-gift-to-basket",type:"GET",dataType:"json",data:{id:n},success:function(n){n.status&&$(".count").html(n.count);NProgress.done()},error:function(){NProgress.done();Swal.fire("Упс!","Что-то пошло не так.","error")}})});$(".btn-delete-product-from-basket").click(function(){var n=$(this).attr("data-id");swal({title:"Вы уверены?",text:"что хотите удалить этот товар!",icon:"warning",buttons:["Отмена","OK"],dangerMode:!0}).then(t=>{t&&(window.location.href="/card/delete-product?id="+n)})});$(".btn-delete-all-product-from-basket").click(function(){var n=$(this).attr("data-id");swal({title:"Вы уверены?",text:"что хотите удалить весь товар!",icon:"warning",buttons:["Отмена","OK"],dangerMode:!0}).then(n=>{n&&(window.location.href="/card/delete-all-product")})});$(".btn-delete-product-from-basket-gift").click(function(){var n=$(this).attr("data-id");swal({title:"Вы уверены?",text:"что хотите удалить этот товар!",icon:"warning",buttons:["Отмена","OK"],dangerMode:!0}).then(t=>{t&&(window.location.href="/card/delete-gift-product?id="+n)})});$(".btn-operation-minus").click(function(){showLoader();var n=$(this).attr("data-id");$.ajax({url:"/card/down-clicked",type:"GET",dataType:"json",data:{id:n},success:function(t){$("#countProduct"+n).html(t.countProduct);$("#sumBasket").html(t.sum+" ₸");$("#sumProduct"+n).html(t.sumProduct+" ₸");$(".count").html(t.header_count);hideLoader()},error:function(){hideLoader();Swal.fire("Упс!","Что-то пошло не так.","error")}})});$(".btn-operation-plus").click(function(){showLoader();var n=$(this).attr("data-id");$.ajax({url:"/card/up-clicked",type:"GET",dataType:"json",data:{id:n},success:function(t){t.status?($("#countProduct"+n).html(t.countProduct),$("#sumBasket").html(t.sum+" ₸"),$("#sumProduct"+n).html(t.sumProduct+" ₸"),$(".count").html(t.header_count),hideLoader()):(hideLoader(),$("#countProduct"+n).val(t.countProduct),Swal.fire("","Извините, у нас нет больше!","error"))},error:function(){hideLoader();Swal.fire("Упс!","Что-то пошло не так.","error")}})});$("#bonus").on("change",function(){showLoader();var n=$(this).val();n>-1?$.ajax({url:"/card/bonus",type:"GET",dataType:"json",data:{bonus:n},success:function(n){$("#sumBasket").html(n.sum+" ₸");n.bonus!=0&&$("#bonus").val(n.bonus);hideLoader()},error:function(){hideLoader();swal("Упс!","Что-то пошло не так.","error")}}):hideLoader()});$(".quantity").on("change paste keyup",function(){showLoader();var n=$(this).attr("data-id"),t=$(this).val();$.ajax({url:"/card/count-changed",type:"GET",dataType:"json",data:{id:n,v:t},success:function(t){t.status?($("#countProduct"+n).html(t.countProduct),$("#sumBasket").html(t.sum+" ₸"),$("#sumProduct"+n).html(t.sumProduct+" ₸"),$(".count").html(t.header_count),hideLoader()):(hideLoader(),$("#countProduct"+n).val(t.countProduct),Swal.fire("","Извините, у нас нет больше!","error"))},error:function(){hideLoader();Swal.fire("Упс!","Что-то пошло не так.","error")}})});$(".button-pay").click(function(){var n=$("#typePay").val();showLoader();$.ajax({type:"GET",url:"/card/order",data:{typePay:n},success:function(n){hideLoader();n==1?window.location.href="/account/?tab=tab-2":n==2?window.location.href="/card/gift":n==0?swal("","Что-то пошло не так!","error"):n==3?window.location.href="/":n==4?swal({title:"",text:"Хотите ли Вы зарегистрироваться?",icon:"info",buttons:["Нет","Да"],dangerMode:!0}).then(n=>{n?window.location.href="/account/sign-up":$("#card-confirm").modal("show")}):n==5?window.location.href="/paybox/index":swal("",n,"error")},error:function(){hideLoader();Swal.fire("Упс!","Что-то пошло не так.","error")}})});$("#typePay").on("change",function(){$(this).val()==1?$(".button-pay").html("Оформить заказ"):$(".button-pay").html("Оплатить");$.ajax({url:"/card/set-payment-choice",type:"GET",data:{payment_choice:$(this).val()},success:function(){}})});$("body").on("click",".order_guest_confirm",function(){showLoader();$.ajax({type:"POST",url:"/card/confirm-ordered-guest-data",data:$(this).closest("form").serialize(),success:function(n){hideLoader();n==1?($(".close").click(),$(".button-pay").click()):swal("",n,"error")},error:function(){hideLoader();Swal.fire("Упс!","Что-то пошло не так.","error")}})})